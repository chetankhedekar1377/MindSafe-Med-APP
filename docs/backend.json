
{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the MindSafe Med application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the User entity."
        },
        "email": {
          "type": "string",
          "description": "User's email address.",
          "format": "email"
        },
        "name": {
          "type": "string",
          "description": "User's full name."
        }
      },
      "required": [
        "id",
        "email"
      ]
    },
    "SymptomLog": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "SymptomLog",
      "type": "object",
      "description": "Represents a log entry for a user's symptom.",
      "properties": {
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N SymptomLog)"
        },
        "date": {
          "type": "string",
          "description": "Date when the symptom was logged.",
          "format": "date-time"
        },
        "symptomName": {
          "type": "string",
          "description": "Name of the symptom."
        },
        "severity": {
          "type": "number",
          "description": "Severity level of the symptom (e.g., 1-10)."
        },
        "notes": {
          "type": "string",
          "description": "Any notes about the symptom."
        }
      },
      "required": [
        "userId",
        "date",
        "symptomName",
        "severity"
      ]
    },
    "Medication": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Medication",
      "type": "object",
      "description": "Represents a medication that a user is taking.",
      "properties": {
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Medication)"
        },
        "name": {
          "type": "string",
          "description": "Name of the medication."
        },
        "dosage": {
          "type": "string",
          "description": "Dosage of the medication."
        },
        "frequency": {
          "type": "string",
          "description": "Frequency of taking the medication."
        }
      },
      "required": [
        "userId",
        "name",
        "dosage",
        "frequency"
      ]
    },
    "MedicationReminder": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "MedicationReminder",
      "type": "object",
      "description": "Represents a reminder for a user to take their medication.",
      "properties": {
        "medicationId": {
          "type": "string",
          "description": "Reference to Medication. (Relationship: Medication 1:N MedicationReminder)"
        },
        "reminderTime": {
          "type": "string",
          "description": "Time of day to send the reminder.",
          "format": "date-time"
        },
        "isTaken": {
          "type": "boolean",
          "description": "Indicates whether the medication has been taken for this reminder."
        }
      },
      "required": [
        "medicationId",
        "reminderTime"
      ]
    },
    "HealthInsight": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "HealthInsight",
      "type": "object",
      "description": "Represents a personalized health insight generated by the AI tool.",
      "properties": {
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N HealthInsight)"
        },
        "generatedText": {
          "type": "string",
          "description": "Textual insight generated by the AI."
        },
        "timestamp": {
          "type": "string",
          "description": "Timestamp when the insight was generated.",
          "format": "date-time"
        }
      },
      "required": [
        "userId",
        "generatedText",
        "timestamp"
      ]
    },
    "TriageSession": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "TriageSession",
      "type": "object",
      "description": "Represents a single, anonymous symptom triage session.",
      "properties": {
        "triageId": {
          "type": "string",
          "description": "Unique identifier for the triage session."
        },
        "primarySymptom": {
          "type": "string",
          "description": "The initial symptom reported by the user."
        },
        "createdAt": {
          "type": "number",
          "description": "Timestamp indicating when the session was started."
        },
        "completedAt": {
          "type": "number",
          "description": "Timestamp for when the session ended."
        },
        "isCompleted": {
          "type": "boolean",
          "description": "Flag indicating if the triage process was finished."
        },
        "finalState": {
          "type": "object",
          "description": "The state of the triage at the end of the session.",
          "properties": {
            "questionHistory": { "type": "array", "items": { "type": "string" } },
            "answers": { "type": "array", "items": { "type": "string", "enum": ["Yes", "No"] } },
            "conditionProbabilities": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "condition": { "type": "string" },
                  "probability": { "type": "number" }
                }
              }
            },
            "redFlag": { "type": "object", "properties": { "reason": { "type": "string" } }, "nullable": true },
            "highestRiskLevel": { "type": "string", "enum": ["GREEN", "YELLOW", "RED"], "nullable": true }
          }
        },
        "finalVerdict": {
          "type": "object",
          "description": "The AI-generated summary provided to the user.",
          "properties": {
            "mostProbableCondition": { "type": "string" },
            "confidenceLevel": { "type": "string" },
            "reasoning": { "type": "string" },
            "nextSteps": { "type": "string" }
          },
          "nullable": true
        },
        "feedback": {
          "type": "object",
          "description": "User feedback submitted after the triage.",
          "properties": {
            "outcome": { "type": "string", "enum": ["Better", "Same", "Worse", "Side Effects"] },
            "feedbackAt": { "type": "number" }
          },
          "nullable": true
        }
      },
      "required": [
        "triageId",
        "primarySymptom",
        "createdAt",
        "isCompleted"
      ]
    }
  },
  "auth": {
    "providers": [
      "anonymous"
    ]
  },
  "firestore": {
    "/users/{userId}": {
      "schema": { "$ref": "#/entities/User" },
      "description": "Stores user profile information."
    },
    "/users/{userId}/symptomLogs/{symptomLogId}": {
      "schema": { "$ref": "#/entities/SymptomLog" },
      "description": "Subcollection for a user's symptom logs."
    },
    "/users/{userId}/medications/{medicationId}": {
      "schema": { "$ref": "#/entities/Medication" },
      "description": "Subcollection for a user's medications."
    },
    "/users/{userId}/medicationReminders/{medicationReminderId}": {
      "schema": { "$ref": "#/entities/MedicationReminder" },
      "description": "Subcollection for a user's medication reminders."
    },
    "/users/{userId}/healthInsights/{healthInsightId}": {
      "schema": { "$ref": "#/entities/HealthInsight" },
      "description": "Subcollection for AI-generated health insights for a user."
    },
    "/triageSessions/{sessionId}": {
      "schema": { "$ref": "#/entities/TriageSession" },
      "description": "Top-level collection to store anonymous triage sessions. Data is write-only for clients to ensure anonymity and data integrity."
    }
  }
}
